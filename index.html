<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Gestion des Stocks</title>

  <!-- Fichier JS principal -->
  <script type="text/javascript" src="getData.js"></script>
</head>

<body>

  <!-- =============================== -->
  <!--       SECTION DE CONNEXION     -->
  <!-- =============================== -->
  <div id="login_section">
    <h1>Connexion</h1>

    <label for="login_username">Nom d'utilisateur :</label>
    <input type="text" id="login_username">
    <br>

    <label for="login_password">Mot de passe :</label>
    <input type="password" id="login_password">
    <br>

    <button type="button" onclick="login()">Se connecter</button>

    <!-- Message d'erreur login -->
    <p id="login_error" style="color:red;"></p>
  </div>

  <!-- ===================================== -->
  <!--   SECTION D'INVENTAIRE (APRÈS LOGIN) -->
  <!-- ===================================== -->
  <div id="inventory_section" style="display:none;">

    <button type="button" onclick="logout()">Déconnexion</button>

    <h1>Inventaire</h1>

    <!-- Affichage du produit sélectionné -->
    <p><strong>Produit :</strong> <span id="affichage_nom"></span></p>
    <p><strong>Stock :</strong> <span id="affichage_stock">0</span></p>

    <!-- Champ pour modifier le stock du produit sélectionné -->
    <input
      type="text"
      id="input_stock"
      placeholder="Entrer un stock (ex: 5, +5, -5)"
    >

    <!-- Actions stock -->
    <button type="button" onclick="definirStock()">Valider</button>
    <button type="button" onclick="stock()">+1</button>
    <button type="button" onclick="retrait()">-1</button>

    <br><br>

    <!-- Sauvegarde navigateur + export CSV -->
    <button type="button" onclick="sauvegarderDansNavigateur()">Sauvegarder (navigateur)</button>
    <button type="button" onclick="exporterCSV()">Exporter CSV</button>

    <br><br>

    <!-- Recherche -->
    <label for="searchInput"><strong>Recherche :</strong></label>
    <input type="text" id="searchInput" placeholder="Tape un code ou un nom..." autocomplete="off">
    <button type="button" onclick="effacerRecherche()">X</button>

    <br><br>

    <!-- Sélection d'un produit -->
    <label for="productSelect">Choisir un produit :</label>
    <select id="productSelect" onchange="afficherProduit()">
      <option value="">-- Sélectionnez un produit --</option>
    </select>

    <br><br>

    <!-- Tableau des produits -->
    <div id="product"></div>

    <hr>

    <!-- ======================== -->
    <!--    AJOUT D'UN PRODUIT   -->
    <!-- ======================== -->

    <!-- Seul ce bouton est visible -->
    <button type="button" id="openAddProduct">Ajouter un produit</button>

    <!-- Popup native HTML -->
    <dialog id="addProductDialog">
      <form method="dialog" id="addProductForm">
        <h2>Ajouter un produit</h2>

        <p>
          <label for="new_code">Code-barres :</label><br>
          <input type="text" id="new_code" required>
        </p>

        <p>
          <label for="new_name">Nom :</label><br>
          <input type="text" id="new_name" required>
        </p>

        <p>
          <label for="new_stock">Stock :</label><br>
          <input type="number" id="new_stock" value="0">
        </p>

        <p>
          <label for="new_min">Stock mini :</label><br>
          <input type="number" id="new_min" value="0">
        </p>

        <p>
          <label for="new_max">Stock maxi :</label><br>
          <input type="number" id="new_max" value="0">
        </p>

        <!-- Boutons de la popup -->
        <menu>
          <button value="cancel">Annuler</button>
          <button id="confirmAddProduct" value="default">Ajouter</button>
        </menu>
      </form>
    </dialog>

  </div>
</body>
</html>
